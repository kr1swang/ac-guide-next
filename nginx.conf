server {
  # basic
  listen 3000;
  listen [::]:3000;
  server_name deeparch_data_contest;
  root /usr/share/nginx/html;

  # check http method legal
  set $method $request_method;
  if ($http_X_HTTP_Method_Override != '') {
    return 405;
  }
  proxy_method $method;

  # gzip compression
  gzip on;
  gzip_disable "msie6";
  gzip_vary on;
  gzip_proxied any;
  gzip_comp_level 6;
  gzip_buffers 16 8k;
  gzip_http_version 1.1;
  gzip_min_length 0;
  gzip_types text/plain application/javascript text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/vnd.ms-fontobject application/x-font-ttf font/opentype;

  # images cache one week
  location ^~ /data-contest/images/ {
    expires 7d;
    add_header Cache-Control "public";
    access_log off;
  }

  # js / css cache one week
  location ^~ /data-contest/static/ {
    expires 7d;
    add_header Cache-Control "public";
    access_log off;
  }

  # index
  location / {
    try_files $uri $uri/ /data-contest/index.html;
    index index.html;
  }
}
